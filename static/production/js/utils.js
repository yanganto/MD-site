var btf={diffDateExact:function(e,t=!1){const n=new Date,o=new Date(e),a=n.getTime()-o.getTime(),i=36e5,r=24*i;let s;if(t){const e=a/r,t=a/i,n=a/6e4;s=a/(30*r)>=1?o.toLocaleDateString().replace(/\//g,"-"):e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else s=parseInt(a/r);return s},debounce:function(e,t,n){let o;return function(){const a=this,i=arguments,r=n&&!o;clearTimeout(o),o=setTimeout((function(){o=null,n||e.apply(a,i)}),t),r&&e.apply(a,i)}},throttle:function(e,t,n){let o,a,i,r=0;n||(n={});const s=function(){r=!1===n.leading?0:(new Date).getTime(),o=null,e.apply(a,i),o||(a=i=null)};return function(){const c=(new Date).getTime();r||!1!==n.leading||(r=c);const l=t-(c-r);a=this,i=arguments,l<=0||l>t?(o&&(clearTimeout(o),o=null),r=c,e.apply(a,i),o||(a=i=null)):o||!1===n.trailing||(o=setTimeout(s,l))}},sidebarPaddingR:()=>{const e=window.innerWidth,t=document.body.clientWidth,n=e-t;e!==t&&(document.body.style.paddingRight=n+"px")},snackbarShow:(e,t=!1,n=2e3,o=!1)=>{const{position:a,bgLight:i,bgDark:r}=GLOBAL_CONFIG.Snackbar,s="light"===document.documentElement.getAttribute("data-theme")?i:r;document.querySelector(":root").style.setProperty("--wjx-snackbar-time",n+"ms"),Snackbar.show({text:e,backgroundColor:s,onActionClick:t,actionText:o,showAction:o,duration:n,pos:a,customClass:"snackbar-css"})},initJustifiedGallerys:function(e){e.forEach((function(e){btf.isHidden(e)||fjGallery(e,{itemSelector:".fj-gallery-item",rowHeight:240,gutter:4,onJustify:function(){this.$container.style.opacity="1"}})})),document.querySelectorAll("#article-container .loadings")[0]?.classList.remove("loadings")},diffDate:(e,t=!1)=>{const n=new Date,o=new Date(e),a=n.getTime()-o.getTime(),i=36e5,r=24*i;let s;if(t){const e=a/r,t=a/i,n=a/6e4;s=a/(30*r)>12?o.toLocaleDateString():e>=7?o.toLocaleDateString().substr(5):e>=1?parseInt(e)+""+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else s=parseInt(a/r);return s},loadComment:(e,t)=>{if("IntersectionObserver"in window){const n=new IntersectionObserver((e=>{e[0].isIntersecting&&(t(),n.disconnect())}),{threshold:[0]});n.observe(e)}else t()},scrollToDest:(e,t)=>{if(e<0||t<0)return;const n=window.scrollY||window.screenTop;if(e-=70,"CSS"in window&&CSS.supports("scroll-behavior","smooth"))return void window.scrollTo({top:e,behavior:"smooth"});let o=null;t=t||500,window.requestAnimationFrame((function a(i){if(o=o||i,n<e){const r=i-o;window.scrollTo(0,(e-n)*r/t+n),r<t?window.requestAnimationFrame(a):window.scrollTo(0,e)}else{const r=i-o;window.scrollTo(0,n-(n-e)*r/t),r<t?window.requestAnimationFrame(a):window.scrollTo(0,e)}}))},fadeIn:(e,t)=>{e.style.cssText=`display:block;animation: to_show ${t}s`},fadeOut:(e,t)=>{e.addEventListener("animationend",(function t(){e.style.cssText="display: none; animation: '' ",e.removeEventListener("animationend",t)})),e.style.animation=`to_hide ${t}s`},getParents:(e,t)=>{for(;e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null},siblings:(e,t)=>[...e.parentNode.children].filter((n=>t?n!==e&&n.matches(t):n!==e)),wrap:function(e,t,n="",o=""){const a=document.createElement(t);n&&(a.id=n),o&&(a.className=o),e.parentNode.insertBefore(a,e),a.appendChild(e)},unwrap:function(e){const t=e.parentNode;t!==document.body&&(t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t))},isJqueryLoad:e=>{"undefined"==typeof jQuery?getScript(GLOBAL_CONFIG.source.jQuery).then(e):e()},isHidden:e=>0===e.offsetHeight&&0===e.offsetWidth,getEleTop:e=>{let t=e.offsetTop,n=e.offsetParent;for(;null!==n;)t+=n.offsetTop,n=n.offsetParent;return t},animateIn:(e,t)=>{e.style.display="block",e.style.animation=t},animateOut:(e,t)=>{e.addEventListener("animationend",(function t(){e.style.display="",e.style.animation="",e.removeEventListener("animationend",t)})),e.style.animation=t},addGlobalFn:(e,t,n=!1,o=window)=>{const a=o.globalFn||{},i=a[e]||{};n&&i[n]||(i[n=n||Object.keys(i).length]=t,a[e]=i,o.globalFn=a)},addEventListenerPjax:(e,t,n,o=!1)=>{e.addEventListener(t,n,o),btf.addGlobalFn("pjax",(()=>{e.removeEventListener(t,n,o)}))},changeContent:(e,t=null)=>(""===e||(e=(e=(e=(e=e.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,""),null!=t&&e.length>t&&(e=e.substring(0,t)+"...")),e)};let wjx_cookiesTime=null,wjx_musicFirst=!1,wjx_musicPlaying=!1,wjx_keyboard=!1,wjx_intype=!1,lastSayHello="",refreshNum=1;var wjx={darkModeStatus:function(){"light"==("dark"===document.documentElement.getAttribute("data-theme")?"dark":"light")?$(".menu-darkmode-text").text("深色模式"):$(".menu-darkmode-text").text("浅色模式")},initIndexEssay:function(){document.querySelector("#bber-talk")&&($(".swiper-wrapper .swiper-slide").each((function(){var e=$(this)[0].innerText;"undefined"!=e&&$(this).text(btf.changeContent(e))})),new Swiper(".swiper-container",{direction:"vertical",loop:!0,autoplay:{delay:3e3,pauseOnMouseEnter:!0}}))},onlyHome:function(){var e=window.location.pathname;"/"==(e=decodeURIComponent(e))?$(".only-home").attr("style","display: flex"):$(".only-home").attr("style","display: none")},is_Post:function(){return window.location.href.indexOf("/archives/")>=0},addNavBackgroundInit:function(){var e=0,t=0;document.body&&(e=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),0!=(e-t>0?e:t)&&(document.getElementById("page-header").classList.add("nav-fixed"),$("#cookies-window").hide())},addFriendLinksInFooter:function(){var e=document.getElementById("footer-random-friends-btn");function t(e){const t=GLOBAL_CONFIG.source.links.linksUrl,n=GLOBAL_CONFIG.source.links.linksNum;var o=new Map;e.forEach((e=>{for(let t of e.links)o.set(t.display_name,t)}));var a=[...o.values()],i=getArrayItems(a,n),r="";for(let e=0;e<i.length;++e){var s=i[e];r+=`<a class='footer-item' href='${s.url}'  target="_blank" rel="noopener nofollow external">${s.display_name}</a>`}r+=`<a class='footer-item' href='${t}'>更多</a>`,document.getElementById("friend-links-in-footer")&&(document.getElementById("friend-links-in-footer").innerHTML=r)}e&&(e.style.opacity="0.2",e.style.transitionDuration="0.3s",e.style.transform="rotate("+360*refreshNum+++"deg)",function(){const n=saveToLocal.get("links-data");n?t(JSON.parse(n)):fetch("/data/friends.json").then((e=>e.json())).then((e=>{saveToLocal.set("links-data",JSON.stringify(e.groups),10/1440),t(e.groups)})),setTimeout((()=>{e.style.opacity="1"}),300)}())},stopImgRightDrag:function(){$("img").on("dragstart",(function(){return!1}))},topPostScroll:function(){if(document.getElementById("recent-post-top")){let e=document.getElementById("recent-post-top");e.addEventListener("mousewheel",(function(t){let n=-t.wheelDelta/2;e.scrollLeft+=n,document.body.clientWidth<768&&t.preventDefault()}),!1)}},topCategoriesBarScroll:function(){if(document.getElementById("category-bar-items")){let e=document.getElementById("category-bar-items");e.addEventListener("mousewheel",(function(t){let n=-t.wheelDelta/2;e.scrollLeft+=n,t.preventDefault()}),!1)}},sayhi:function(){"default"==GLOBAL_CONFIG.profileStyle?document.querySelector("#author-info__sayhi")&&(document.getElementById("author-info__sayhi").innerHTML=getTimeState()+"！我是"):document.querySelector("#author-info__sayhi")&&(document.getElementById("author-info__sayhi").innerHTML=getTimeState())},qrcodeCreate:function(){if(document.getElementById("qrcode")){document.getElementById("qrcode").innerHTML="";new QRCode(document.getElementById("qrcode"),{text:window.location.href,width:250,height:250,colorDark:"#000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}},reflashEssayWaterFall:function(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall")&&document.getElementById("waterfall").classList.add("show")}),500)},downloadImage:function(e,t){rm.hideRightMenu(),0==rm.downloadimging?(rm.downloadimging=!0,btf.snackbarShow("正在下载中，请稍后",!1,1e4),setTimeout((function(){let n=new Image;n.setAttribute("crossOrigin","anonymous"),n.onload=function(){let e=document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0,n.width,n.height);let o=e.toDataURL("image/png"),a=document.createElement("a"),i=new MouseEvent("click");a.download=t||"photo",a.href=o,a.dispatchEvent(i)},n.src=e,btf.snackbarShow("图片已添加盲水印，请遵守版权协议"),rm.downloadimging=!1}),"10000")):btf.snackbarShow("有正在进行中的下载，请稍后再试")},switchCommentBarrage:function(){document.querySelector(".comment-barrage")&&($(".comment-barrage").is(":visible")?($(".comment-barrage").hide(),$(".menu-commentBarrage-text").text("显示热评"),document.querySelector("#consoleCommentBarrage").classList.remove("on"),localStorage.setItem("commentBarrageSwitch","false"),btf.snackbarShow("✨ 已关闭评论弹幕",!1,2e3)):$(".comment-barrage").is(":hidden")&&($(".comment-barrage").show(),$(".menu-commentBarrage-text").text("关闭热评"),document.querySelector("#consoleCommentBarrage").classList.add("on"),localStorage.removeItem("commentBarrageSwitch"),btf.snackbarShow("✨ 已开启评论弹幕",!1,2e3))),GLOBAL_CONFIG.rightMenuEnable&&rm.hideRightMenu()},hidecookie:function(){wjx_cookiesTime=setTimeout((()=>{document.getElementById("cookies-window").classList.add("cw-hide"),setTimeout((()=>{$("#cookies-window").hide()}),1e3)}),3e3)},hideTodayCard:function(){document.getElementById("topGroup")&&document.getElementById("topGroup").classList.add("hideCard")},changeThemeColor:function(e){null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content",e)},initThemeColor:function(){if(wjx.is_Post()){if(0===(window.scrollY||document.documentElement.scrollTop)){let e=getComputedStyle(document.documentElement).getPropertyValue("--wjx-main");wjx.changeThemeColor(e)}else{let e=getComputedStyle(document.documentElement).getPropertyValue("--wjx-background");wjx.changeThemeColor(e)}}else{let e=getComputedStyle(document.documentElement).getPropertyValue("--wjx-background");wjx.changeThemeColor(e)}},jumpTo:function(e){$(document).ready((function(){$("html,body").animate({scrollTop:$(e).eq(i).offset().top},500)}))},showLoading:function(){document.getElementById("loading-box").classList.remove("loaded");let e=getComputedStyle(document.documentElement).getPropertyValue("--wjx-card-bg");wjx.changeThemeColor(e)},hideLoading:function(){document.getElementById("loading-box").classList.add("loaded")},musicToggle:function(e=!0){const t=document.getElementById("nav-music");wjx_musicFirst||(wjx.musicBindEvent(),wjx_musicFirst=!0);wjx_musicPlaying?(t.classList.remove("playing"),GLOBAL_CONFIG.rightMenuEnable&&(document.getElementById("menu-music-toggle").innerHTML='<i class="icon-play"></i><span>播放音乐</span>'),document.getElementById("nav-music-hoverTips").innerHTML="音乐已暂停",document.querySelector("#consoleMusic").classList.remove("on"),wjx_musicPlaying=!1,t.classList.remove("stretch")):(t.classList.add("playing"),GLOBAL_CONFIG.rightMenuEnable&&(document.getElementById("menu-music-toggle").innerHTML='<i class="icon-pause"></i><span>暂停音乐</span>'),document.querySelector("#consoleMusic").classList.add("on"),wjx_musicPlaying=!0,t.classList.add("stretch")),e&&document.querySelector("#nav-music meting-js").aplayer.toggle(),GLOBAL_CONFIG.rightMenuEnable&&rm.hideRightMenu()},musicBindEvent:function(){document.querySelector("#nav-music .aplayer-music").addEventListener("click",(function(){wjx.musicTelescopic()})),document.querySelector("#nav-music .aplayer-button").addEventListener("click",(function(){wjx.musicToggle(!1)}))},musicTelescopic:function(){const e=document.getElementById("nav-music");e.classList.contains("stretch")?e.classList.remove("stretch"):e.classList.add("stretch")},musicSkipBack:function(){document.querySelector("meting-js").aplayer.skipBack(),rm.hideRightMenu()},musicSkipForward:function(){document.querySelector("meting-js").aplayer.skipForward(),rm.hideRightMenu()},musicGetName:function(){for(var e=$(".aplayer-title"),t=[],n=e.length-1;n>=0;n--)t[n]=e[n].innerText;return t[0]},rewardShowConsole:function(){$(".console-card-group-reward").attr("style","display: flex"),$(".console-card-group").attr("style","display: none"),document.querySelector("#console").classList.add("show"),wjx.initConsoleState()},showConsole:function(){$(".console-card-group-reward").attr("style","display: none"),$(".console-card-group").attr("style","display: flex"),document.querySelector("#console").classList.add("show")},hideConsole:function(){document.querySelector("#console").classList.remove("show")},keyboardToggle:function(){wjx_keyboard?(wjx_keyboard=!1,document.querySelector("#consoleKeyboard").classList.remove("on"),localStorage.setItem("keyboardToggle","false")):(wjx_keyboard=!0,document.querySelector("#consoleKeyboard").classList.add("on"),localStorage.setItem("keyboardToggle","true"))},scrollTo:function(e){const t=document.getElementById(e);if(t){const e=t.getBoundingClientRect().top+window.pageYOffset-80,n=window.pageYOffset,o=e-n;let a=null;window.requestAnimationFrame((function e(t){a||(a=t);const i=t-a,r=(s=Math.min(i/0,1))<.5?2*s*s:(4-2*s)*s-1;var s;window.scrollTo(0,n+o*r),i<600&&window.requestAnimationFrame(e)}))}},hideAsideBtn:()=>{const e=document.documentElement.classList;e.contains("hide-aside")?saveToLocal.set("aside-status","show",2):saveToLocal.set("aside-status","hide",2),e.toggle("hide-aside"),e.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},toPage:function(){var e=document.querySelectorAll(".page-number"),t=parseInt(e[e.length-1].innerHTML),n=document.getElementById("toPageText"),o=parseInt(n.value);if(!isNaN(o)&&o>0&&"0"!==(""+o)[0]&&o<=t){var a=window.location.href,i=a.indexOf("?group")>=0?a.indexOf("?group"):-1;if(i>=0){var r=a.substr(0,i),s=a.substr(i),c=r.replace(/\/page\/\d$/,"");l=1===o?c:c+(c.endsWith("/")?"":"/")+"page/"+o,document.getElementById("toPageButton").href=l+s}else{var l;c=a.replace(/\/page\/\d$/,"");if(1==o)var d=paginatorFirstUrl;else d=paginatorBaseUrl+o;document.getElementById("toPageButton").href=d}scrollToPost()}},changeSayHelloText:function(){const e=0==GLOBAL_CONFIG.helloText.length?["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]:GLOBAL_CONFIG.helloText,t=document.getElementById("author-info__sayhi");if(1===e.length)return void(t.textContent=e[0]);let n=e[Math.floor(Math.random()*e.length)];for(;n===lastSayHello;)n=e[Math.floor(Math.random()*e.length)];t.textContent=n,lastSayHello=n},addRandomCommentInfo:function(){const e=`${adjectives[Math.floor(Math.random()*adjectives.length)]}${vegetablesAndFruits[Math.floor(Math.random()*vegetablesAndFruits.length)]}`;!function(){for(var t=["#author","input[name='comname']","#inpName","input[name='author']","#ds-dialog-name","#name","input[name='nick']","#comment_author"],n=["#mail","#email","input[name='commail']","#inpEmail","input[name='email']","#ds-dialog-email","input[name='mail']","#comment_email"],o=0;o<t.length;o++){var a=document.querySelector(t[o]);if(null!=a){a.value=e,a.dispatchEvent(new Event("input")),a.dispatchEvent(new Event("change"));break}}for(var i=0;i<n.length;i++){var r=document.querySelector(n[i]);if(null!=r){r.value=visitorMail,r.dispatchEvent(new Event("input")),r.dispatchEvent(new Event("change"));break}}}();var t=document.getElementsByClassName(GLOBAL_CONFIG.source.comments.textarea)[0];t.focus(),t.setSelectionRange(-1,-1)},addPowerLinksInPostRightSide:async function(){const e=document.getElementById("power-star-image"),t=document.getElementById("power-star"),n=document.getElementById("power-star-title"),o=document.getElementById("power-star-desc");if(e&&t&&n&&o)try{const a=GLOBAL_CONFIG.source.power.list,i=a[wjx.getRandomInt(0,a.length)].realNode;e.style.backgroundImage=`url(${i.avatar})`,t.href=i.link,n.innerText=i.name,o.innerText=i.descr}catch(e){}},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e))+e},initConsoleState:function(){document.documentElement.classList.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},changeMusicBg:function(e=!0){if("/music"!=window.location.pathname)return;const t=document.getElementById("an_music_bg");if(e){const e=document.querySelector("#anMusic-page .aplayer-pic");t.style.backgroundImage=e.style.backgroundImage}else{let e=setInterval((()=>{const n=document.querySelector("#anMusic-page .aplayer-pic");n&&(clearInterval(e),t.style.backgroundImage=n.style.backgroundImage,wjx.addEventListenerChangeMusicBg(),GLOBAL_CONFIG.navMusicEnable&&document.querySelector("#nav-music meting-js").aplayer&&!document.querySelector("#nav-music meting-js").aplayer.audio.paused&&wjx.musicToggle())}),100)}},addEventListenerChangeMusicBg:function(){const e=document.getElementById("anMusic-page"),t=e.querySelector(".aplayer-info .aplayer-time .aplayer-icon-menu");e.querySelector("meting-js").aplayer.on("loadeddata",(function(){wjx.changeMusicBg(),console.info("player loadeddata")})),t.addEventListener("click",(function(){$(".music-mask").css("display","block"),$(".music-mask").css("animation","0.5s ease 0s 1 normal none running to_show")})),$(".music-mask").click((function(){e.querySelector(".aplayer-list").classList.remove("aplayer-list-hide"),$(".music-mask").hide()}))}};const adjectives=["美丽的","英俊的","聪明的","勇敢的","可爱的","慷慨的","善良的","可靠的","开朗的","成熟的","稳重的","真诚的","幽默的","豁达的","有趣的","活泼的","优雅的","敏捷的","温柔的","温暖的","敬业的","细心的","耐心的","深沉的","朴素的","含蓄的","率直的","开放的","务实的","坚强的","自信的","谦虚的","文静的","深刻的","纯真的","朝气蓬勃的","慎重的","大方的","顽强的","迷人的","机智的","善解人意的","富有想象力的","有魅力的","独立的","好奇的","干净的","宽容的","尊重他人的","体贴的","守信的","有耐性的","有责任心的","有担当的","有远见的","有智慧的","有眼光的","有冒险精神的","有爱心的","有同情心的","喜欢思考的","喜欢学习的","具有批判性思维的","善于表达的","善于沟通的","善于合作的","善于领导的","有激情的","有幽默感的","有思想的","有个性的","有正义感的","有责任感的","有创造力的","有想象力的","有艺术细胞的","有团队精神的","有协调能力的","有决策能力的","有组织能力的","有学习能力的","有执行能力的","有分析能力的","有逻辑思维的","有创新能力的","有专业素养的","有商业头脑的"],vegetablesAndFruits=["萝卜","白菜","芹菜","生菜","青椒","辣椒","茄子","豆角","黄瓜","西红柿","洋葱","大蒜","土豆","南瓜","豆腐","韭菜","花菜","西兰花","蘑菇","金针菇","苹果","香蕉","橙子","柠檬","猕猴桃","草莓","葡萄","桃子","杏子","李子","石榴","西瓜","哈密瓜","蜜瓜","樱桃","蓝莓","柿子","橄榄","柚子","火龙果"];